<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Calcurator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’å„ªå…ˆçš„ã«ä½¿ç”¨ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F5; /* è–„ã„ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column; /* ç¸¦ä¸¦ã³ã«å¤‰æ›´ */
            min-height: 100vh;
            margin: 0;
            padding: 1rem; /* å…¨ä½“ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¿½åŠ  */
        }
        h1 {
            color: #2c3e50; /* ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ«ãƒ¼ã®ãƒ†ã‚­ã‚¹ãƒˆ */
            margin-bottom: 2rem; /* ãƒãƒ¼ã‚¸ãƒ³ã‚’å¢—ã‚„ã™ */
            font-size: 2.5rem; /* ã‚¿ã‚¤ãƒˆãƒ«ã‚’é©åº¦ãªã‚µã‚¤ã‚ºã«ä¿®æ­£ */
            font-weight: 700; /* å¤ªå­— */
            text-align: center;
        }
        .main-content-container {
            display: flex;
            gap: 1.5rem; /* å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³é–“ã®éš™é–“ */
            flex-wrap: wrap; /* ç”»é¢å¹…ãŒç‹­ã„å ´åˆã«æŠ˜ã‚Šè¿”ã™ */
            justify-content: center;
            align-items: flex-start; /* ä¸Šç«¯ã‚’æƒãˆã‚‹ */
            max-width: 900px; /* å…¨ä½“ã®å¹…ã‚’åºƒã */
            width: 100%;
        }
        .input-section, .result-section {
            flex: 1 1 10%; /* 300pxã®æœ€å°å¹…ã‚’æŒã¤ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ã‚¢ã‚¤ãƒ†ãƒ  */
            background-color: #fff; /* èƒŒæ™¯è‰²ã‚’ç™½ã«å¤‰æ›´ */
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* ãƒ‰ãƒ­ãƒƒãƒ—ã‚·ãƒ£ãƒ‰ã‚¦ã‚’è¿½åŠ  */
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-section {
            background-color: #fff;
            padding: 1rem;
        }
        .input-group {
            margin-bottom: 0;
            text-align: left;
            flex: 1; /* å‡ç­‰ãªå¹…ã«ã™ã‚‹ */
        }
        .input-group + .input-group {
            margin-top: 1.5rem; /* input-sectionå†…ã§é–“éš”ã‚’èª¿æ•´ */
        }
        label {
            display: block;
            margin-bottom: 0.75rem;
            color: #34495e;
            font-size: 1.125rem;
            font-weight: 600;
        }
        input[type="number"] {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid #cbd5e0;
            border-radius: 0.75rem;
            font-size: 1.125rem;
            color: #2c3e50;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            outline: none;
        }
        input[type="number"]:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.25);
        }
        /* æŠµæŠ—å€¤ãŒä½ã„/é«˜ã„å ´åˆã®è­¦å‘Šã‚¹ã‚¿ã‚¤ãƒ« */
        input[type="number"].resistance-alert {
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.25);
        }
        .result-box {
            background-color: #ecf0f1;
            padding: 1.5rem;
            border-radius: 1rem;
            margin-top: 0; /* è¦ªã‚³ãƒ³ãƒ†ãƒŠã®gapã§èª¿æ•´ */
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            flex-direction: column; /* ç¸¦ä¸¦ã³ã«ã™ã‚‹ */
            justify-content: center;
            align-items: center;
            min-height: 50px; /* é«˜ã•ã®æœ€å°å€¤ã‚’ä¿®æ­£ */
        }
        .result-box.alert {
            background-color: #fee2e2;
            color: #ef4444;
        }
        .unit {
            font-size: 1rem;
            color: #7f8c8d;
            margin-left: 0.5rem;
        }
        /* è¨­å®šãƒœã‚¿ãƒ³ã¨ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .settings-link {
            margin-top: 0.5rem;
            text-align: right;
        }
        .settings-link a {
            color: #7f8c8d; /* ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² */
            font-size: 0.9rem;
            text-decoration: none; /* ã“ã“ã‚’noneã«å¤‰æ›´ */
            cursor: pointer;
            transition: color 0.3s ease-in-out;
        }
        .settings-link a:hover {
            color: #34495e;
        }
        .modal {
            display: none; /* åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º */
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4); /* èƒŒæ™¯ã‚’æš—ã */
            padding-top: 60px;
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 400px;
            text-align: left;
            position: relative;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
        }
        .modal-content h2 {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        /* é›»æ± ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .battery-icon-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 0px;
        }
        .battery-icon {
            width: 80px;
            height: 20px;
            border: none;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 2px;
        }
        .battery-icon::after {
            content: '';
            width: 6px;
            height: 12px;
            background-color: #333;
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 0 2px 2px 0;
        }
        .battery-bar {
            width: 12px;
            height: 100%;
            border-radius: 2px;
            background-color: #ccc;
        }
        /* æ–°ã—ã„ã‚¿ã‚¤ãƒˆãƒ«ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        .title-container h1 {
            font-size: 2.5rem; /* ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
            font-weight: 800; /* ã•ã‚‰ã«å¤ªã */
            color: #34495e;
            margin: 0;
            letter-spacing: -1px;
        }
        .title-container p {
            font-size: 1.25rem;
            color: #7f8c8d;
            margin-top: 0.5rem;
        }
        .current-value {
            font-size: 1rem; /* æ–‡å­—ã‚µã‚¤ã‚ºã‚’å°ã•ã */
        }

        /* å˜ä½ã¨ãƒ©ãƒ™ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .unit-label {
            display: flex;
            align-items: flex-end;
            gap: 0.25rem;
            font-size: 1.5rem; /* å˜ä½ã‚’å¤§ãã */
            font-weight: 600;
        }
        .unit-label-small {
            font-size: 0.75rem; /* æ—¥æœ¬èªã‚’å°ã•ã */
            font-weight: 400;
            color: #7f8c8d;
        }
        
        /* æ—©è¦‹è¡¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .chart-container {
            margin-top: 2.5rem;
            background-color: transparent;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: none;
        }
        .chart-container h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            text-align: center;
            color: #2c3e50;
        }
        .setting-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .setting-table th, .setting-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.8rem; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’è¿½åŠ  */
        }
        .setting-table th {
            background-color: #f7f7f7;
            font-weight: 600;
            color: #4a5568;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .setting-table tr:hover {
            background-color: #f0f4f8;
        }
        .setting-table td.highlight {
            background-color: #DCDCDC; /* è‰²ã‚’è–„ã„ã‚°ãƒ¬ãƒ¼ã«å¤‰æ›´ */
            transition: background-color 0.3s ease-in-out;
        }
        .setting-table td:nth-child(1) {
            font-weight: 600;
        }
        .setting-table tr:last-child td {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="title-container">
        <h1>POWER CALCULATOR</h1>
    </div>

    <div class="main-content-container">
        <!-- æŠµæŠ—ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="input-section">
            <div class="input-group">
                <label for="resistance" class="unit-label">
                    Î© <span class="unit-label-small">æŠµæŠ—</span>
                </label>
                <input type="number" id="resistance" placeholder="ä¾‹: 0.3" step="0.01" value="0.4" min="0.2" max="1.2">
            </div>
            <div class="settings-link">
                <a href="#" id="openModalButton">âš™ï¸ è¨­å®š</a>
            </div>
        </div>

        <!-- é›»åœ§ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="input-section">
            <div class="input-group">
                <label for="voltage" class="unit-label">
                    V <span class="unit-label-small">é›»åœ§</span>
                </label>
                <input type="number" id="voltage" placeholder="ä¾‹: 4.2" step="0.1" value="4.0" min="3.0" max="4.2">
            </div>
        </div>

        <!-- çµæœè¡¨ç¤ºã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="result-section">
            <!-- é›»åŠ› (W) ã®è¡¨ç¤ºã‚’ç¸¦ä¸¦ã³ã« -->
            <div class="result-box" id="powerResult">
                <div class="unit-label">
                    W <span class="unit-label-small">é›»åŠ›</span>
                </div>
                <div>
                    <span id="powerValue">0</span><span class="unit">W</span>
                </div>
                <div class="battery-icon-container">
                    <div class="battery-icon" id="batteryIcon">
                        <div class="battery-bar" id="bar1"></div>
                        <div class="battery-bar" id="bar2"></div>
                        <div class="battery-bar" id="bar3"></div>
                        <div class="battery-bar" id="bar4"></div>
                        <div class="battery-bar" id="bar5"></div>
                    </div>
                </div>
            </div>
            <!-- é›»æµ (A) ã®è¡¨ç¤ºã‚’æ¨ªä¸¦ã³ã« -->
            <div class="result-box" id="currentResult" style="flex-direction: row; justify-content: center; align-items: center; gap: 0.5rem; text-align: center; padding: 0;">
                <div class="unit-label">
                    A <span class="unit-label-small">é›»æµ</span>
                </div>
                <span id="currentValue">0</span><span class="unit">A</span>
            </div>
        </div>
    </div>

    <!-- æ—©è¦‹è¡¨ã®ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div class="chart-container">
        <h2>ğŸ’¨VAPEã‚»ãƒƒãƒ†ã‚£ãƒ³ã‚°åˆ†é¡è¡¨ï¼ˆç›®å®‰ï¼‰</h2>
        <table class="setting-table">
            <thead>
                <tr>
                    <th>ã‚µã‚¤ã‚ºæ„Ÿ</th>
                    <th>ãƒ¯ãƒƒãƒˆæ•°</th>
                    <th>ã‚¨ã‚¢ãƒ•ãƒ­ãƒ¼</th>
                    <th>æŠµæŠ—å€¤</th>
                    <th>ãƒªã‚­ãƒƒãƒ‰æ¯”ç‡ï¼ˆVG:PGï¼‰</th>
                    <th>ç‰¹å¾´</th>
                </tr>
            </thead>
            <tbody>
                <tr id="rowXSmall">
                    <td>XSmall</td>
                    <td id="wattXSmall">20ã€œ30W</td>
                    <td>10ï¼…é–‹ã‘ï¼ˆè¶…ã‚¿ã‚¤ãƒˆï¼‰</td>
                    <td id="ohmXSmall">0.9ã€œ1.2Î©</td>
                    <td>50:50ã€œ60:40</td>
                    <td>å‘³é‡è¦–ã€MTLç‰¹åŒ–ã€ç…™å°‘ãªã‚ã€ãƒ‹ã‚³ç³»ã«æœ€é©</td>
                </tr>
                <tr id="rowSmall">
                    <td>Small</td>
                    <td id="wattSmall">30ã€œ40W</td>
                    <td>25ï¼…é–‹ã‘ï¼ˆã‚„ã‚„ã‚¿ã‚¤ãƒˆï¼‰</td>
                    <td id="ohmSmall">0.6ã€œ0.9Î©</td>
                    <td>60:40ã€œ70:30</td>
                    <td>æ¿ƒã„å‘³ï¼‹ã¡ã‚‡ã£ã¨ç…™ã€ã‚»ãƒŸMTLå‘ã‘</td>
                </tr>
                <tr id="rowMedium">
                    <td>Medium</td>
                    <td id="wattMedium">40ã€œ50W</td>
                    <td>50ï¼…é–‹ã‘ï¼ˆåŠåˆ†ï¼‰</td>
                    <td id="ohmMedium">0.4ã€œ0.6Î©</td>
                    <td>70:30</td>
                    <td>ãƒãƒ©ãƒ³ã‚¹â—ï¼å‘³ã¨ç…™ã®ãƒ™ã‚¹ãƒˆãƒŸãƒƒã‚¯ã‚¹ã€DLåˆå¿ƒè€…ã«ã‚‚</td>
                </tr>
                <tr id="rowLarge">
                    <td>Large</td>
                    <td id="wattLarge">45ã€œ55W</td>
                    <td>75ï¼…é–‹ã‘ï¼ˆåºƒã‚ï¼‰</td>
                    <td id="ohmLarge">0.25ã€œ0.4Î©</td>
                    <td>70:30ã€œ80:20</td>
                    <td>çˆ†ç…™å¯„ã‚Šã€ãƒˆãƒªãƒƒã‚¯å…¥é–€å‘ã‘ã€ç†±ããªã‚Šã™ãæ³¨æ„</td>
                </tr>
                <tr id="rowXLarge">
                    <td>XLarge</td>
                    <td id="wattXLarge">55ã€œ65Wâ†‘</td>
                    <td>å…¨é–‹ï¼ˆã‚¹ã‚«ã‚¹ã‚«ï¼‰</td>
                    <td id="ohmXLarge">0.1ã€œ0.25Î©</td>
                    <td>80:20ã€œ90:10</td>
                    <td>çˆ†ç…™ãƒ»çˆ†ç†±ãƒ»ã‚¬ãƒãƒˆãƒªãƒƒã‚¯å‘ã‘ã€ä¾›çµ¦æ³¨æ„âš </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>æŠµæŠ—è­¦å‘Šè¨­å®š</h2>
            <div class="input-group">
                <label for="resistanceLowerLimitInput">æŠµæŠ—è­¦å‘Šä¸‹é™ (Î©):</label>
                <input type="number" id="resistanceLowerLimitInput" step="0.01" value="0.24">
            </div>
            <div class="input-group">
                <label for="resistanceUpperLimitInput">æŠµæŠ—è­¦å‘Šä¸Šé™ (Î©):</label>
                <input type="number" id="resistanceUpperLimitInput" step="0.01" value="0.55">
            </div>
        </div>
    </div>


    <script>
        // DOMè¦ç´ ã‚’å–å¾—
        const resistanceInput = document.getElementById('resistance');
        const voltageInput = document.getElementById('voltage');
        const powerResultBox = document.getElementById('powerResult');
        const powerValueSpan = document.getElementById('powerValue');
        const currentResultBox = document.getElementById('currentResult');
        const currentValueSpan = document.getElementById('currentValue');
        const batteryIcon = document.getElementById('batteryIcon');
        const bars = [];
        for (let i = 1; i <= 5; i++) {
            bars.push(document.getElementById(`bar${i}`));
        }
        
        // æ—©è¦‹è¡¨ã®DOMè¦ç´ ã‚’å–å¾—
        const wattCells = {
            'XSmall': document.getElementById('wattXSmall'),
            'Small': document.getElementById('wattSmall'),
            'Medium': document.getElementById('wattMedium'),
            'Large': document.getElementById('wattLarge'),
            'XLarge': document.getElementById('wattXLarge')
        };
        const ohmCells = {
            'XSmall': document.getElementById('ohmXSmall'),
            'Small': document.getElementById('ohmSmall'),
            'Medium': document.getElementById('ohmMedium'),
            'Large': document.getElementById('ohmLarge'),
            'XLarge': document.getElementById('ohmXLarge')
        };
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£ã®DOMè¦ç´ ã‚’å–å¾—
        const openModalButton = document.getElementById('openModalButton');
        const settingsModal = document.getElementById('settingsModal');
        const closeButton = document.querySelector('.close-button');

        // è¨­å®šå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®DOMè¦ç´ ã‚’å–å¾—
        const resistanceLowerLimitInput = document.getElementById('resistanceLowerLimitInput');
        const resistanceUpperLimitInput = document.getElementById('resistanceUpperLimitInput');
        
        // é›»åŠ›è­¦å‘Šã®ä¸Šé™å€¤ã¯å›ºå®š
        const powerLimit = 80;

        /**
         * é›»åŠ›ï¼ˆWï¼‰ã¨é›»æµï¼ˆAï¼‰ã‚’è¨ˆç®—ã—ã€çµæœã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
         * P = V^2 / R ãŠã‚ˆã³ I = V / R ã®å…¬å¼ã‚’ä½¿ç”¨
         */
        function calculatePowerAndCurrent() {
            // å…¥åŠ›å€¤ã‚’å–å¾—ã—ã€æ•°å€¤ã«å¤‰æ›
            const resistance = parseFloat(resistanceInput.value);
            const voltage = parseFloat(voltageInput.value);

            // è¨­å®šå€¤ã‚’å–å¾—ã—ã€æ•°å€¤ã«å¤‰æ›
            const resistanceLowerLimit = parseFloat(resistanceLowerLimitInput.value);
            const resistanceUpperLimit = parseFloat(resistanceUpperLimitInput.value);

            // æŠµæŠ—å€¤ãŒä¸‹é™å€¤ä»¥ä¸‹ã€ã¾ãŸã¯ä¸Šé™å€¤ä»¥ä¸Šã®å ´åˆã«è­¦å‘Šã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
            if (!isNaN(resistance) && (resistance <= resistanceLowerLimit || resistance >= resistanceUpperLimit)) {
                resistanceInput.classList.add('resistance-alert');
            } else {
                resistanceInput.classList.remove('resistance-alert');
            }

            // ä¸¡æ–¹ã®å…¥åŠ›ãŒæœ‰åŠ¹ãªæ•°å€¤ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
            if (!isNaN(resistance) && !isNaN(voltage) && resistance !== 0) {
                // é›»åŠ›Pã‚’è¨ˆç®—
                const power = (voltage * voltage) / resistance;
                // é›»æµIã‚’è¨ˆç®—
                const current = voltage / resistance;

                // çµæœã‚’å°æ•°ç‚¹ä»¥ä¸‹2æ¡ã«ä¸¸ã‚ã‚‹
                const roundedPower = power.toFixed(2);
                const roundedCurrent = current.toFixed(2);

                // çµæœã‚’è¡¨ç¤º
                powerValueSpan.textContent = roundedPower;
                currentValueSpan.textContent = roundedCurrent;

                // é›»åŠ›ä¸Šé™å€¤ã‚’è¶…ãˆã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
                if (power >= powerLimit) {
                    powerResultBox.classList.add('alert');
                } else {
                    powerResultBox.classList.remove('alert');
                }

                // é›»æ± ã‚¢ã‚¤ã‚³ãƒ³ã®è¡¨ç¤ºã‚’æ›´æ–°
                updateBatteryIcon(power);
                // æ—©è¦‹è¡¨ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’æ›´æ–°
                highlightTable(power, resistance);

            } else {
                // å…¥åŠ›ãŒç„¡åŠ¹ãªå ´åˆã¯0ã‚’è¡¨ç¤ºã—ã€ã‚¢ãƒ©ãƒ¼ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã‚’å‰Šé™¤
                powerValueSpan.textContent = '0';
                currentValueSpan.textContent = '0';
                powerResultBox.classList.remove('alert');
                updateBatteryIcon(0);
                highlightTable(null, null); // ç„¡åŠ¹ãªå ´åˆã¯ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
            }
        }

        /**
         * é›»åŠ›å€¤ã«åŸºã¥ã„ã¦é›»æ± ã‚¢ã‚¤ã‚³ãƒ³ã®è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
         * @param {number} power - è¨ˆç®—ã•ã‚ŒãŸé›»åŠ›å€¤
         */
        function updateBatteryIcon(power) {
            // ã¾ãšå…¨ã¦ã®æ£’ã®è‰²ã‚’ãƒªã‚»ãƒƒãƒˆ
            bars.forEach(bar => bar.style.backgroundColor = '#ccc');

            // é›»åŠ›å€¤ã«åŸºã¥ã„ã¦æ£’ã®è‰²ã¨æœ¬æ•°ã‚’è¨­å®š
            if (power <= 39.9) {
                // é»„è‰² (åˆè¨ˆ1æœ¬)
                bars[0].style.backgroundColor = '#fcd34d';
            } else if (power >= 40.0 && power <= 49.9) {
                // ç·‘è‰² (åˆè¨ˆ2æœ¬)
                bars[0].style.backgroundColor = '#34d399';
                bars[1].style.backgroundColor = '#34d399';
            } else if (power >= 50.0 && power <= 59.9) {
                // ç·‘è‰² (åˆè¨ˆ3æœ¬)
                bars[0].style.backgroundColor = '#34d399';
                bars[1].style.backgroundColor = '#34d399';
                bars[2].style.backgroundColor = '#34d399';
            } else if (power >= 60.0 && power <= 69.9) {
                // ç·‘è‰² (åˆè¨ˆ4æœ¬)
                bars[0].style.backgroundColor = '#34d399';
                bars[1].style.backgroundColor = '#34d399';
                bars[2].style.backgroundColor = '#34d399';
                bars[3].style.backgroundColor = '#34d399';
            } else if (power >= 70.0) {
                // èµ¤è‰² (åˆè¨ˆ5æœ¬)
                for (let i = 0; i < 5; i++) {
                    bars[i].style.backgroundColor = '#ef4444';
                }
            }
        }

        /**
         * æŠµæŠ—å€¤ã¨é›»åŠ›å€¤ã«åŸºã¥ã„ã¦æ—©è¦‹è¡¨ã®è©²å½“ã‚»ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹é–¢æ•°
         * @param {number} power - è¨ˆç®—ã•ã‚ŒãŸé›»åŠ›å€¤
         * @param {number} resistance - è¨ˆç®—ã•ã‚ŒãŸæŠµæŠ—å€¤
         */
        function highlightTable(power, resistance) {
            // ã¾ãšå…¨ã¦ã®ã‚»ãƒ«ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å‰Šé™¤
            for (const key in wattCells) {
                wattCells[key].classList.remove('highlight');
            }
            for (const key in ohmCells) {
                ohmCells[key].classList.remove('highlight');
            }

            if (power === null || isNaN(power) || resistance === null || isNaN(resistance)) return;

            // é›»åŠ›å€¤ã®ç¯„å›²ã«åŸºã¥ã„ã¦ãƒ¯ãƒƒãƒˆæ•°ã®ã‚»ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            if (power >= 20 && power <= 30) {
                wattCells['XSmall'].classList.add('highlight');
            } else if (power > 30 && power <= 40) {
                wattCells['Small'].classList.add('highlight');
            } else if (power > 40 && power <= 50) {
                wattCells['Medium'].classList.add('highlight');
            } else if (power > 45 && power <= 55) {
                wattCells['Large'].classList.add('highlight');
            } else if (power > 55) {
                wattCells['XLarge'].classList.add('highlight');
            }

            // æŠµæŠ—å€¤ã®ç¯„å›²ã«åŸºã¥ã„ã¦æŠµæŠ—å€¤ã®ã‚»ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            if (resistance >= 0.9 && resistance <= 1.2) {
                ohmCells['XSmall'].classList.add('highlight');
            } else if (resistance > 0.6 && resistance <= 0.9) {
                ohmCells['Small'].classList.add('highlight');
            } else if (resistance > 0.4 && resistance <= 0.6) {
                ohmCells['Medium'].classList.add('highlight');
            } else if (resistance > 0.25 && resistance <= 0.4) {
                ohmCells['Large'].classList.add('highlight');
            } else if (resistance > 0.1 && resistance <= 0.25) {
                ohmCells['XLarge'].classList.add('highlight');
            }
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        openModalButton.addEventListener('click', (event) => {
            event.preventDefault();
            settingsModal.style.display = 'block';
        });

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        closeButton.addEventListener('click', () => {
            settingsModal.style.display = 'none';
        });

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é–‰ã˜ã‚‹
        window.addEventListener('click', (event) => {
            if (event.target === settingsModal) {
                settingsModal.style.display = 'none';
            }
        });

        // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«è¨ˆç®—é–¢æ•°ã‚’å‘¼ã³å‡ºã™
        resistanceInput.addEventListener('input', calculatePowerAndCurrent);
        voltageInput.addEventListener('input', calculatePowerAndCurrent);

        // è¨­å®šå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«è¨ˆç®—é–¢æ•°ã‚’å‘¼ã³å‡ºã™
        resistanceLowerLimitInput.addEventListener('input', calculatePowerAndCurrent);
        resistanceUpperLimitInput.addEventListener('input', calculatePowerAndCurrent);

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¸€åº¦è¨ˆç®—ã‚’å®Ÿè¡Œï¼ˆåˆæœŸè¡¨ç¤ºã®ãŸã‚ï¼‰
        calculatePowerAndCurrent();
    </script>
</body>
</html>
